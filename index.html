<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8">
  <title>Menu Circular com Câmara de Fundo</title>
  <style>
    /* Reset e configuração da página */
    html,
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: sans-serif;
    }

    /* Vídeo de fundo (stream da câmara) */
    #camera {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: -1;
    }

    /* Painel de menu branco que desliza */
    #menu {
      position: fixed;
      top: 0;
      right: 0;
      width: 600px;
      height: 100%;
      background: rgba(255, 255, 255, 0.95);
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    #menu.open {
      transform: translateX(0%);
    }

    /* Ícone para abrir/fechar o menu */
    #menuIcon {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 40px;
      height: 40px;
      background-color: white;
      border: 2px solid #ccc;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }

    /* Lista de palavras – posicionada de forma relativa para permitir posicionamento absoluto dos itens */
    #wordList {
      position: relative;
      width: 100%;
      height: 100%;
      padding: 0;
      margin: 0;
      list-style: none;
    }

    /* Cada item é posicionado absolutamente */
    #wordList li {
      position: absolute;
      left: 50px;
      white-space: nowrap;
      font-size: 48px;
      padding: 24px;
      transition: opacity 0.3s, transform 0.3s;
    }
  </style>
</head>

<body>
  <!-- Vídeo de fundo -->
  <video id="camera" autoplay playsinline></video>

  <!-- Menu com forma circular -->
  <div id="menu">
    <ul id="wordList">
      <li>Tritanopia</li>
      <li>Protanopia</li>
      <li>Nistagmo</li>
      <li>Glaucoma</li>
      <li>Miopia</li>
      <li>Estrabismo</li>
      <li>Acromatopsia</li>
      <li>Deuteranopia</li>
    </ul>
  </div>

  <!-- Ícone para abrir/fechar o menu -->
  <div id="menuIcon">&#9776;</div>

  <script>
    // 1. Ativar a câmara de fundo
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
      navigator.mediaDevices.getUserMedia({ video: true })
        .then(function (stream) {
          document.getElementById('camera').srcObject = stream;
        })
        .catch(function (err) {
          console.error("Erro ao aceder à câmara:", err);
        });
    }

    /*
      2. Configurações para o menu circular:
         - Usamos uma variável global "baseAngle" (em graus) para controlar a rotação inicial.
         - Distribuímos os itens igualmente ao longo dos 360°.
         - O scroll (evento wheel) incrementa ou decrementa "baseAngle", fazendo com que os itens girem.
         - Calculamos a posição (x, y) de cada item com base na fórmula:
               x = centerX + radius * cos(angle)
               y = centerY + radius * sin(angle)
         - A opacidade é ajustada conforme a diferença (em graus) entre o ângulo do item e o ângulo alvo (aqui, 90° – posição inferior).
    */
    let baseAngle = 0; // em graus
    const wordList = document.getElementById('wordList');
    const items = wordList.querySelectorAll('li');
    const totalItems = items.length;

    // Obtemos dimensões básicas do menu circular
    const menu = document.getElementById('menu');
    const menuWidth = menu.clientWidth;
    const menuHeight = menu.clientHeight;
    const centerX = menuWidth;
    const centerY = menuHeight / 2;
    const radius = centerX - 300; // margem para que o texto não fique colado na borda

    // Ângulo alvo para opacidade máxima (ex: 90° = parte de baixo do círculo)
    const targetAngle = 90;

    function updateItems() {
      const angleStep = 360 / totalItems;
      items.forEach((item, index) => {
        // Calcula o ângulo deste item somando o offset global (baseAngle)
        let itemAngle = (baseAngle + index * angleStep) % 360;
        if (itemAngle < 0) itemAngle += 360;
        // Converter para radianos
        const rad = itemAngle * Math.PI / 180;
        // Posição x e y (centralizando o item)
        const x = centerX + radius * Math.cos(rad) - item.offsetWidth / 2;
        const y = centerY + radius * Math.sin(rad) - item.offsetHeight / 2;
        item.style.left = `${x}px`;
        item.style.top = `${y}px`;

        // Cálculo da opacidade: quanto menor a diferença entre itemAngle e targetAngle, mais alta a opacidade
        let diff = Math.abs(itemAngle - targetAngle);
        if (diff > 180) diff = 360 - diff; // pega no menor ângulo
        // Opacidade: 1 para diff = 0 e 0.2 para diff >= 90
        const opacity = Math.max(0.2, 1 - (diff / 90) * 0.8);
        item.style.opacity = opacity;
      });
    }

    // Atualiza as posições e opacidades inicialmente
    updateItems();

    // 3. Evento de scroll para rotação infinita.
    menu.addEventListener('wheel', (e) => {
      e.preventDefault();
      // Ajusta o baseAngle de acordo com a direção do scroll (o fator 0.1 define a sensibilidade)
      baseAngle += e.deltaY * 0.1;
      updateItems();
    });

    // 4. Alternar a visibilidade do menu ao clicar no ícone
    document.getElementById('menuIcon').addEventListener('click', function () {
      menu.classList.toggle('open');
    });

    // Opcional: atualizar posições se a janela for redimensionada (para garantir o posicionamento correto)
    window.addEventListener('resize', updateItems);
  </script>
</body>

</html>